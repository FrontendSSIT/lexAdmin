
@{
    ViewBag.Title = "Add";
}

<div class="row">
    <div class="col-md-2">

    </div>
    <div class="col-md-8">
        <h2 style="text-align:center">Add Product</h2>
@using (Html.BeginForm("Add", "Product", FormMethod.Post,new { @enctype = "multipart/form-data" }))
{
    <fieldset>
        <div class="form-group">
            <label class="control-label col-sm-2" for="productName">Product Name</label>
            <div class="col-sm-10">
                <input type="text" class="form-control" id="productName" placeholder="Enter product name" name="productName" required>
            </div>
        </div>
        @*<div class="form-group">
            <label class="control-label col-sm-2" for="category">Category</label>
            <div class="col-sm-10">
                <select class="form-control" id="category">
                    <option>car</option>
                    <option>bike</option>
                    <option>headphone</option>
                    <option>t-shirt</option>
                </select>

            </div>
        </div>*@
        <div class="form-group">
            <label class="control-label col-sm-2" for="productDescription">Description</label>
            <div class="col-sm-10">
                <textarea type="text" class="form-control" id="productDescription" placeholder="Enter description" name="productDescription" required></textarea>
           </div>
        </div>
        <div class="form-group">
            <label class="control-label col-sm-2" for="productPrice">Price</label>
            <div class="col-sm-10">
                <input type="text" class="form-control" id="productPrice" placeholder="Enter price" name="productPrice" required>
            </div>
        </div>
        <div class="form-group">
            <label class="control-label col-sm-2" for="image">Load Image</label>
            <div class="col-sm-10 pt-2">

                <input type="file"  onchange="encodeImgtoBase64(this, '1')">
                <input  type="hidden" id="file1" name="file1"/>
                <input type="hidden" id="thumbnailFile1" name="thumbnailFile1" />
            </div>
            <div class="col-sm-10 pt-4">
                <input type="file"  onchange="encodeImgtoBase64(this, '2')">
                <input type="hidden" id="file2" name="file2" />
                <input type="hidden" id="thumbnailFile2" name="thumbnailFile2" />
            </div>
            <div class="col-sm-10 pt-4">
                <input type="file" onchange="encodeImgtoBase64(this, '3')">
                <input type="hidden" id="file3" name="file3" />
                <input type="hidden" id="thumbnailFile3" name="thumbnailFile3" />
            </div>
            <div class="col-sm-10 pt-4">
                <input type="file" onchange="encodeImgtoBase64(this, '4')">
                <input type="hidden" id="file4" name="file4" />
                <input type="hidden" id="thumbnailFile4" name="thumbnailFile4" />
            </div>
            <div class="col-sm-10 pt-4">
                <input type="file" onchange="encodeImgtoBase64(this, '5')">
                <input type="hidden" id="file5" name="file5" />
                <input type="hidden" id="thumbnailFile5" name="thumbnailFile5" />
            </div>
        </div>
       @*<div>
           <p>Thumbnail image</p>
           <img id="thumbnail" src=""/>
           <input type="hidden" id="thumbnailImage" name="thumbnailImage" />

       </div>*@
        <div class="form-group">
            <div class="col-sm-offset-2 col-sm-10">
                <button type="submit" class="btn btn-default btn-primary">Submit</button>
            </div>
        </div>
    </fieldset>

}
    </div>
    <div class="col-md-2">

    </div>
</div>
@section Scripts{
    <script type="text/javascript">

   function encodeImgtoBase64(element, fileNo) {

      var file = element.files[0];

      var reader = new FileReader();

      reader.onloadend = function() {

          var text = reader.result;
          var imageFile = text.replace(/^data:image\/[a-z]+;base64,/, "");
          $('#file' + fileNo).val(imageFile);
        //  $("#convertImg").attr("src", reader.result);
        //$("#convertImg").text(reader.result);

          //$("#base64Img").attr("src", reader.result);

          var sourceImage = text,
		  thumbnail = document.getElementById("thumbnail");

          thumbnailify(sourceImage, 300, function(base64Thumbnail) {
              //thumbnail.src = base64Thumbnail;
              //$("#thumbnail").attr("src", base64Thumbnail);
              var thumbnailImage = base64Thumbnail.replace(/^data:image\/[a-z]+;base64,/, "");
              $('#thumbnailFile' + fileNo).val(thumbnailImage);
          });
          }
          if (file) {
              reader.readAsDataURL(file);
          }
     

    }
   function thumbnailify(base64Image, targetSize, callback) {
       var img = new Image();

       img.onload = function () {
           var width = img.width,
               height = img.height,
               canvas = document.createElement('canvas'),
               ctx = canvas.getContext("2d");

           canvas.width = canvas.height = targetSize;

           ctx.drawImage(
             img,
             width > height ? (width - height) / 2 : 0,
             height > width ? (height - width) / 2 : 0,
             width > height ? height : width,
             width > height ? height : width,
             0, 0,
             targetSize, targetSize
           );

           callback(canvas.toDataURL());
       };

       img.src = base64Image;
   };
</script>
    
    }
